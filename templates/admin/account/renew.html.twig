{% extends 'admin/base.html.twig' %}

{% set ui = {
    tr: {
        title: 'Abonelik Yenile',
        header: 'Abonelik Yenileme',
        last_subscription: 'Son aboneliginiz',
        end_date: 'bitis tarihi',
        note: 'Tum planlar 1 yillik baslar. Yenilemede secilen plan 1 yil daha aktif edilir.',
        plan_select: 'Plan Secimi',
        select_plan: 'Plan seciniz',
        per_year: '/ yil',
        restaurant_short: 'restoran',
        user_short: 'kullanici',
        renew_button: 'Aboneligi 1 Yil Yenile'
    },
    en: {
        title: 'Renew Subscription',
        header: 'Subscription Renewal',
        last_subscription: 'Your last subscription',
        end_date: 'end date',
        note: 'All plans start for 1 year. The selected plan is extended by 1 year on renewal.',
        plan_select: 'Plan Selection',
        select_plan: 'Select a plan',
        per_year: '/ year',
        restaurant_short: 'restaurants',
        user_short: 'users',
        renew_button: 'Renew Subscription for 1 Year'
    },
    ar: {
        title: 'تجديد الاشتراك',
        header: 'تجديد الاشتراك',
        last_subscription: 'آخر اشتراك لديك',
        end_date: 'تاريخ الانتهاء',
        note: 'تبدأ كل الخطط لمدة سنة واحدة. يتم تمديد الخطة المختارة سنة إضافية عند التجديد.',
        plan_select: 'اختيار الخطة',
        select_plan: 'اختر خطة',
        per_year: '/ سنة',
        restaurant_short: 'مطاعم',
        user_short: 'مستخدمين',
        renew_button: 'تجديد الاشتراك لمدة سنة'
    },
    ru: {
        title: 'Продление подписки',
        header: 'Продление подписки',
        last_subscription: 'Ваша последняя подписка',
        end_date: 'дата окончания',
        note: 'Все планы рассчитаны на 1 год. Выбранный план продлевается на 1 год.',
        plan_select: 'Выбор плана',
        select_plan: 'Выберите план',
        per_year: '/ год',
        restaurant_short: 'ресторанов',
        user_short: 'пользователей',
        renew_button: 'Продлить подписку на 1 год'
    }
}[currentLocale] ?? {
    title: 'Renew Subscription',
    header: 'Subscription Renewal',
    last_subscription: 'Your last subscription',
    end_date: 'end date',
    note: 'All plans start for 1 year. The selected plan is extended by 1 year on renewal.',
    plan_select: 'Plan Selection',
    select_plan: 'Select a plan',
    per_year: '/ year',
    restaurant_short: 'restaurants',
    user_short: 'users',
    renew_button: 'Renew Subscription for 1 Year'
} %}

{% block title %}{{ ui.title }}{% endblock %}

{% block body %}
<div class="row justify-content-center">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-header"><strong>{{ ui.header }}</strong></div>
            <div class="card-body">
                {% if latestSubscription %}
                    <div class="alert alert-warning">
                        {{ ui.last_subscription }}:
                        <strong>{{ latestSubscription.plan.name }}</strong>,
                        {{ ui.end_date }}: <strong>{{ latestSubscription.endsAt|date('d.m.Y') }}</strong>.
                    </div>
                {% endif %}

                <p class="text-muted mb-3">{{ ui.note }}</p>

                <form method="post" action="{{ path('admin_account_subscription_renew_submit') }}" class="row g-3">
                    <input type="hidden" name="_token" value="{{ csrf_token('account_subscription_renew') }}">
                    <div class="col-12">
                        <label class="form-label">{{ ui.plan_select }}</label>
                        <select class="form-select" name="plan_id" required>
                            <option value="">{{ ui.select_plan }}</option>
                            {% for plan in plans %}
                                <option
                                    value="{{ plan.id }}"
                                    {{ latestSubscription and latestSubscription.plan.id == plan.id ? 'selected' : '' }}
                                >
                                    {{ plan.name }} - {{ plan.yearlyPrice }} TRY {{ ui.per_year }} ({{ plan.maxRestaurants }} {{ ui.restaurant_short }} / {{ plan.maxUsers }} {{ ui.user_short }})
                                </option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-12">
                        <button class="btn btn-primary">{{ ui.renew_button }}</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}
