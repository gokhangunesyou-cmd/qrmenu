{% extends 'base.html.twig' %}

{% set meta = {
    tr: {
        title: 'Altay QR Menu | Yeni Nesil Restoran Sitesi',
        description: 'Restoran operasyonu, QR menu yayini ve yonetim panelini tek akista gosteren modern public site.',
        keywords: 'qr menu, restoran paneli, dijital menu, qr kod menu, restoran yazilim'
    },
    en: {
        title: 'Altay QR Menu | Next-Gen Restaurant Website',
        description: 'Modern public site that presents QR menu publishing and operations in a single flow.',
        keywords: 'qr menu, restaurant panel, digital menu, qr code menu, restaurant software'
    }
}[currentLocale] ?? {
    title: 'Altay QR Menu | Next-Gen Restaurant Website',
    description: 'Modern public site that presents QR menu publishing and operations in a single flow.',
    keywords: 'qr menu, restaurant panel, digital menu, qr code menu, restaurant software'
} %}

{% set ui = {
    tr: {
        nav_slider: 'Slider',
        nav_features: 'Ozellikler',
        nav_panel: 'Panel',
        nav_proof: 'Test Akisi',
        nav_plans: 'Planlar',
        nav_references: 'Referanslar',
        nav_blog: 'Blog',
        nav_contact: 'Iletisim',
        plan_cta: 'Plani Sec',
        blog_read: 'Detayi Oku',
        blog_empty: 'Henuz yayinlanmis blog yazisi yok',
        contact_email: 'E-posta',
        contact_phone: 'Telefon',
        proof_title: 'Gercek Test Ekranlari',
        proof_note: 'Asagidaki gorseller, e2e senaryosunda olusan gercek test ekran goruntuleridir.',
        hero_kicker: 'Production-Ready Public Site',
        hero_badge: 'Yeni Template',
        price_suffix: '/ yil'
    },
    en: {
        nav_slider: 'Slider',
        nav_features: 'Features',
        nav_panel: 'Panel',
        nav_proof: 'Test Flow',
        nav_plans: 'Plans',
        nav_references: 'References',
        nav_blog: 'Blog',
        nav_contact: 'Contact',
        plan_cta: 'Choose Plan',
        blog_read: 'Read Details',
        blog_empty: 'No published post yet',
        contact_email: 'Email',
        contact_phone: 'Phone',
        proof_title: 'Real Test Screens',
        proof_note: 'The images below are real screenshots generated by the e2e scenario.',
        hero_kicker: 'Production-Ready Public Site',
        hero_badge: 'New Template',
        price_suffix: '/ year'
    }
}[currentLocale] ?? {
    nav_slider: 'Slider',
    nav_features: 'Features',
    nav_panel: 'Panel',
    nav_proof: 'Test Flow',
    nav_plans: 'Plans',
    nav_references: 'References',
    nav_blog: 'Blog',
    nav_contact: 'Contact',
    plan_cta: 'Choose Plan',
    blog_read: 'Read Details',
    blog_empty: 'No published post yet',
    contact_email: 'Email',
    contact_phone: 'Phone',
    proof_title: 'Real Test Screens',
    proof_note: 'The images below are real screenshots generated by the e2e scenario.',
    hero_kicker: 'Production-Ready Public Site',
    hero_badge: 'New Template',
    price_suffix: '/ year'
} %}

{% set testFlow = [
    {
        title: '01 Home',
        body: 'Public acilis sayfasi ve tema ilk gorunumu.',
        image: '/assets/test-flow/01-home.png'
    },
    {
        title: '02 Signup',
        body: 'Kayit formunun bos durum testi.',
        image: '/assets/test-flow/02-signup-page.png'
    },
    {
        title: '04 Login',
        body: 'Kayit sonrasi giris akisi testi.',
        image: '/assets/test-flow/04-login-after-signup.png'
    },
    {
        title: '05 Dashboard',
        body: 'Yonetim paneli ilk dashboard gorunumu.',
        image: '/assets/test-flow/05-dashboard.png'
    },
    {
        title: '08 Restaurant',
        body: 'Profil guncelleme sonrasi restoran ozeti.',
        image: '/assets/test-flow/08-restaurant-show-updated.png'
    }
] %}

{% block title %}{{ meta.title }}{% endblock %}
{% block meta_description %}{{ meta.description }}{% endblock %}
{% block meta_keywords %}{{ meta.keywords }}{% endblock %}
{% block og_title %}{{ meta.title }}{% endblock %}
{% block og_description %}{{ meta.description }}{% endblock %}
{% block twitter_description %}{{ meta.description }}{% endblock %}

{% block stylesheets %}
    <link href="https://fonts.googleapis.com/css2?family={{ theme.font_head|replace({' ': '+'}) }}:wght@500;600;700;800&family={{ theme.font_body|replace({' ': '+'}) }}:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: {{ theme.palette.primary }};
            --primary-dark: {{ theme.palette.primaryDark }};
            --primary-light: {{ theme.palette.primaryLight }};
            --accent: {{ theme.palette.accent }};
            --bg: {{ theme.palette.background }};
            --surface: {{ theme.palette.surface }};
            --text: {{ theme.palette.text }};
            --muted: {{ theme.palette.muted }};
            --border: {{ theme.palette.border }};
            --highlight: {{ theme.palette.highlight }};
            --hero-glow: {{ theme.palette.heroGlow }};
        }

        * { box-sizing: border-box; }

        html { scroll-behavior: smooth; }

        body {
            margin: 0;
            color: var(--text);
            font-family: '{{ theme.font_body }}', sans-serif;
            background:
                radial-gradient(circle at 10% 0%, var(--hero-glow), transparent 40%),
                radial-gradient(circle at 95% 15%, rgba(255, 98, 80, 0.16), transparent 36%),
                linear-gradient(140deg, rgba(255, 255, 255, 0.7), transparent 45%),
                var(--bg);
        }

        body::before {
            content: '';
            position: fixed;
            inset: 0;
            pointer-events: none;
            background-image:
                linear-gradient(rgba(255, 255, 255, 0.24) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 255, 255, 0.24) 1px, transparent 1px);
            background-size: 28px 28px;
            mask-image: radial-gradient(circle at center, black 25%, transparent 85%);
            opacity: 0.4;
            z-index: -1;
        }

        h1, h2, h3, h4 {
            margin: 0;
            letter-spacing: -0.02em;
            font-family: '{{ theme.font_head }}', sans-serif;
        }

        p { margin: 0; }

        a {
            color: inherit;
            text-decoration: none;
        }

        .container {
            width: min(1220px, 92vw);
            margin: 0 auto;
        }

        .topbar {
            position: sticky;
            top: 0;
            z-index: 20;
            backdrop-filter: blur(14px);
            background: color-mix(in srgb, var(--surface) 82%, transparent);
            border-bottom: 1px solid var(--border);
        }

        .nav {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
            padding: 0.95rem 0;
        }

        .brand {
            display: inline-flex;
            align-items: center;
            gap: 0.7rem;
            font-weight: 700;
        }

        .brand-mark {
            width: 36px;
            height: 36px;
            border-radius: 12px;
            display: grid;
            place-items: center;
            color: #fff;
            font-size: 0.72rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            box-shadow: 0 12px 28px color-mix(in srgb, var(--primary) 36%, transparent);
        }

        .nav-links {
            display: flex;
            gap: 0.55rem;
            flex-wrap: wrap;
            font-size: 0.92rem;
        }

        .nav-links a {
            padding: 0.4rem 0.62rem;
            border-radius: 999px;
            border: 1px solid transparent;
            transition: all 0.2s ease;
        }

        .nav-links a:hover {
            border-color: var(--border);
            background: var(--highlight);
        }

        .lang-switch {
            display: inline-flex;
            gap: 0.38rem;
            padding: 0.28rem;
            border-radius: 999px;
            border: 1px solid var(--border);
            background: var(--surface);
        }

        .lang-switch a {
            font-size: 0.78rem;
            padding: 0.2rem 0.5rem;
            border-radius: 999px;
        }

        .lang-switch a.active {
            background: var(--primary);
            color: #fff;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.35rem;
            border-radius: 999px;
            padding: 0.74rem 1.32rem;
            border: 1px solid transparent;
            font-weight: 600;
            transition: all 0.2s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: #fff;
            box-shadow: 0 16px 28px color-mix(in srgb, var(--primary) 35%, transparent);
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 20px 34px color-mix(in srgb, var(--primary) 45%, transparent);
        }

        .btn-ghost {
            border-color: var(--border);
            background: color-mix(in srgb, var(--surface) 72%, transparent);
        }

        .hero {
            padding: 4rem 0 2.8rem;
        }

        .hero-grid {
            display: grid;
            gap: 2.2rem;
            align-items: center;
            grid-template-columns: repeat(auto-fit, minmax(290px, 1fr));
        }

        .hero-kicker {
            display: inline-flex;
            gap: 0.5rem;
            align-items: center;
            padding: 0.34rem 0.9rem;
            border-radius: 999px;
            color: var(--primary-dark);
            background: var(--highlight);
            border: 1px solid var(--border);
            font-size: 0.82rem;
            margin-bottom: 1rem;
        }

        .hero h1 {
            font-size: clamp(2.1rem, 4.4vw, 4rem);
            line-height: 1.04;
            margin-bottom: 1rem;
        }

        .hero p {
            color: var(--muted);
            font-size: 1.05rem;
            margin-bottom: 1.6rem;
            max-width: 58ch;
        }

        .hero-actions {
            display: flex;
            gap: 0.8rem;
            flex-wrap: wrap;
        }

        .hero-card {
            position: relative;
            overflow: hidden;
            border-radius: 28px;
            border: 1px solid var(--border);
            background: color-mix(in srgb, var(--surface) 92%, transparent);
            box-shadow: 0 32px 70px rgba(10, 24, 45, 0.16);
            padding: 1.2rem;
            animation: rise-in 640ms ease;
        }

        .hero-card img {
            width: 100%;
            border-radius: 20px;
            border: 1px solid var(--border);
            display: block;
        }

        .hero-pill {
            position: absolute;
            top: 1.1rem;
            right: 1.1rem;
            display: inline-flex;
            align-items: center;
            padding: 0.3rem 0.7rem;
            border-radius: 999px;
            background: color-mix(in srgb, var(--accent) 92%, white 8%);
            color: #fff;
            font-size: 0.78rem;
            font-weight: 700;
            animation: pulse 2s ease infinite;
        }

        .section {
            padding: 3.1rem 0;
        }

        .section-header {
            display: flex;
            align-items: end;
            justify-content: space-between;
            gap: 1.2rem;
            margin-bottom: 1.7rem;
        }

        .section-header p {
            max-width: 58ch;
            color: var(--muted);
        }

        .card-grid {
            display: grid;
            gap: 1.05rem;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
        }

        .card {
            border: 1px solid var(--border);
            border-radius: 20px;
            background: color-mix(in srgb, var(--surface) 94%, transparent);
            box-shadow: 0 16px 34px rgba(15, 23, 42, 0.08);
            padding: 1.2rem;
            animation: rise-in 420ms ease;
        }

        .card p {
            margin-top: 0.6rem;
            color: var(--muted);
        }

        .panel-card img,
        .slider-card img,
        .proof-card img {
            width: 100%;
            border-radius: 14px;
            border: 1px solid var(--border);
            margin-bottom: 0.8rem;
            display: block;
        }

        .proof-grid {
            display: grid;
            gap: 1rem;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        }

        .proof-card {
            background: linear-gradient(160deg, color-mix(in srgb, var(--surface) 90%, transparent), color-mix(in srgb, var(--highlight) 62%, transparent));
        }

        .plans-grid {
            display: grid;
            gap: 1rem;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
        }

        .plan-price {
            margin-top: 0.9rem;
            font-size: 1.35rem;
            font-weight: 700;
            color: var(--primary-dark);
        }

        .plan-limits {
            margin: 0.75rem 0 1.05rem;
            display: grid;
            gap: 0.35rem;
            color: var(--muted);
            font-size: 0.93rem;
        }

        .footer {
            border-top: 1px solid var(--border);
            margin-top: 2.2rem;
            padding: 1.8rem 0;
            color: var(--muted);
        }

        @keyframes rise-in {
            from { transform: translateY(8px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.04); }
            100% { transform: scale(1); }
        }

        @media (max-width: 980px) {
            .nav-links { display: none; }
            .nav { flex-wrap: wrap; }
        }

        @media (max-width: 640px) {
            .hero { padding-top: 3rem; }
            .hero-card { padding: 1rem; }
            .section { padding: 2.4rem 0; }
            .lang-switch { order: 4; width: 100%; justify-content: center; }
        }
    </style>
{% endblock %}

{% block body %}
    <div class="topbar">
        <div class="container nav">
            <div class="brand">
                <span class="brand-mark">QR</span>
                <span>{{ cms.headerBrand }}</span>
            </div>
            <nav class="nav-links">
                <a href="#slider">{{ ui.nav_slider }}</a>
                <a href="#features">{{ ui.nav_features }}</a>
                <a href="#panel">{{ ui.nav_panel }}</a>
                <a href="#proof">{{ ui.nav_proof }}</a>
                <a href="#plans">{{ ui.nav_plans }}</a>
                <a href="#references">{{ ui.nav_references }}</a>
                <a href="#blog">{{ ui.nav_blog }}</a>
                <a href="#contact">{{ ui.nav_contact }}</a>
            </nav>
            <div class="lang-switch">
                {% for locale, label in availableLocales %}
                    <a href="{{ path('site_home', {lang: locale}) }}" class="{{ locale == currentLocale ? 'active' : '' }}">{{ label }}</a>
                {% endfor %}
            </div>
            <a href="{{ cms.headerCtaUrl }}" class="btn btn-primary">{{ cms.headerCtaText }}</a>
        </div>
    </div>

    {% for widget in widgets %}
        {% if widget.type == 'hero' %}
            <section class="hero">
                <div class="container hero-grid">
                    <div>
                        <div class="hero-kicker">{{ widget.config.eyebrow ?: ui.hero_kicker }}</div>
                        <h1>{{ widget.config.title }}</h1>
                        <p>{{ widget.config.description }}</p>
                        <div class="hero-actions">
                            <a class="btn btn-primary" href="{{ widget.config.primary_url }}">{{ widget.config.primary_text }}</a>
                            <a class="btn btn-ghost" href="{{ widget.config.secondary_url }}">{{ widget.config.secondary_text }}</a>
                        </div>
                    </div>
                    <div class="hero-card">
                        <span class="hero-pill">{{ widget.config.badge ?: ui.hero_badge }}</span>
                        <img src="{{ widget.config.image_url }}" alt="{{ widget.config.title }}">
                    </div>
                </div>
            </section>
        {% endif %}
    {% endfor %}

    {% for widget in widgets %}
        {% if widget.type == 'slider' %}
            <section class="section" id="slider">
                <div class="container">
                    <div class="section-header">
                        <h2>{{ widget.config.title }}</h2>
                        <p>{{ widget.config.note }}</p>
                    </div>
                    <div class="card-grid">
                        {% for item in sliderItems %}
                            <article class="card slider-card">
                                <small>{{ item.kicker }}</small>
                                <h3>{{ item.title }}</h3>
                                <p>{{ item.body }}</p>
                                {% if item.imageUrl %}
                                    <img src="{{ item.imageUrl }}" alt="{{ item.title }}">
                                {% endif %}
                            </article>
                        {% else %}
                            <article class="card">Slider icerigi bulunamadi.</article>
                        {% endfor %}
                    </div>
                </div>
            </section>
        {% endif %}
    {% endfor %}

    {% for widget in widgets %}
        {% if widget.type == 'features' %}
            <section class="section" id="features">
                <div class="container">
                    <div class="section-header">
                        <h2>{{ widget.config.title }}</h2>
                        <p>{{ widget.config.note }}</p>
                    </div>
                    <div class="card-grid">
                        {% for item in widget.config.items_json|default([]) %}
                            <article class="card">
                                <h3>{{ item.title }}</h3>
                                <p>{{ item.body }}</p>
                            </article>
                        {% endfor %}
                    </div>
                </div>
            </section>
        {% endif %}
    {% endfor %}

    {% for widget in widgets %}
        {% if widget.type == 'panel' %}
            <section class="section" id="panel">
                <div class="container">
                    <div class="section-header">
                        <h2>{{ widget.config.title }}</h2>
                        <p>{{ widget.config.note }}</p>
                    </div>
                    <div class="card-grid">
                        {% for shot in widget.config.shots_json|default([]) %}
                            <article class="card panel-card">
                                <img src="{{ shot.image }}" alt="{{ shot.title }}">
                                <h3>{{ shot.title }}</h3>
                                <p>{{ shot.body }}</p>
                            </article>
                        {% endfor %}
                    </div>
                </div>
            </section>
        {% endif %}
    {% endfor %}

    <section class="section" id="proof">
        <div class="container">
            <div class="section-header">
                <h2>{{ ui.proof_title }}</h2>
                <p>{{ ui.proof_note }}</p>
            </div>
            <div class="proof-grid">
                {% for item in testFlow %}
                    <article class="card proof-card">
                        <img src="{{ item.image }}" alt="{{ item.title }}">
                        <h3>{{ item.title }}</h3>
                        <p>{{ item.body }}</p>
                    </article>
                {% endfor %}
            </div>
        </div>
    </section>

    {% for widget in widgets %}
        {% if widget.type == 'plans' %}
            <section class="section" id="plans">
                <div class="container">
                    <div class="section-header">
                        <h2>{{ widget.config.title }}</h2>
                        <p>{{ widget.config.note }}</p>
                    </div>
                    <div class="plans-grid">
                        {% for plan in plans %}
                            <article class="card">
                                <h3>{{ plan.name }}</h3>
                                <p>{{ plan.description ?: widget.config.note }}</p>
                                <div class="plan-price">{{ plan.yearlyPrice }} TRY {{ ui.price_suffix }}</div>
                                <div class="plan-limits">
                                    <div>Restoran limiti: <strong>{{ plan.maxRestaurants }}</strong></div>
                                    <div>Kullanici limiti: <strong>{{ plan.maxUsers }}</strong></div>
                                </div>
                                <a class="btn btn-primary" href="{{ path('site_signup', {lang: currentLocale}) }}">{{ ui.plan_cta }}</a>
                            </article>
                        {% endfor %}
                    </div>
                </div>
            </section>
        {% endif %}
    {% endfor %}

    {% for widget in widgets %}
        {% if widget.type == 'references' %}
            <section class="section" id="references">
                <div class="container">
                    <div class="section-header">
                        <h2>{{ widget.config.title }}</h2>
                        <p>{{ widget.config.note }}</p>
                    </div>
                    <div class="card-grid">
                        {% for item in widget.config.items_json|default([]) %}
                            <article class="card">
                                <h3>{{ item.title }}</h3>
                                <p>{{ item.body }}</p>
                            </article>
                        {% endfor %}
                    </div>
                </div>
            </section>
        {% endif %}
    {% endfor %}

    {% for widget in widgets %}
        {% if widget.type == 'blog' %}
            <section class="section" id="blog">
                <div class="container">
                    <div class="section-header">
                        <h2>{{ widget.config.title }}</h2>
                        <p>{{ widget.config.note }}</p>
                    </div>
                    <div class="card-grid">
                        {% for post in posts %}
                            {% set view = postView[post.id] ?? {title: post.title, body: post.body} %}
                            <article class="card">
                                <h3>{{ view.title }}</h3>
                                <p>{{ view.body|striptags|slice(0, 170) }}...</p>
                                <a class="btn btn-ghost" href="{{ path('site_blog_detail', {slug: post.slug, lang: currentLocale}) }}">{{ ui.blog_read }}</a>
                            </article>
                        {% else %}
                            <article class="card">{{ ui.blog_empty }}</article>
                        {% endfor %}
                    </div>
                </div>
            </section>
        {% endif %}
    {% endfor %}

    {% for widget in widgets %}
        {% if widget.type == 'contact' %}
            <section class="section" id="contact">
                <div class="container">
                    <div class="section-header">
                        <h2>{{ widget.config.title }}</h2>
                        <p>{{ widget.config.note }}</p>
                    </div>
                    <div class="card-grid">
                        <article class="card">
                            <h3>{{ ui.contact_email }}</h3>
                            <p>{{ widget.config.email }}</p>
                        </article>
                        <article class="card">
                            <h3>{{ ui.contact_phone }}</h3>
                            <p>{{ widget.config.phone }}</p>
                        </article>
                    </div>
                </div>
            </section>
        {% endif %}
    {% endfor %}

    {% for widget in widgets %}
        {% if widget.type == 'custom_html' %}
            <section class="section">
                <div class="container">
                    {{ widget.config.html|raw }}
                </div>
            </section>
        {% endif %}
    {% endfor %}

    <footer class="footer">
        <div class="container">{{ cms.footerText }}</div>
    </footer>
{% endblock %}
